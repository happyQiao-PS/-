# 正则爬虫



### 正则表达式复习

- 正则表达式的定义：

  - 就是用事先制定好的一些特定字符，及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。

  - 常用正则表达式的方法：

    ```python
    re.complie(编译)
    pattern.match(从头找一个)
    pattern.search(找一个)
    pattern.findall(找所有)
    pattern.sub(替换)
    ```

  - #### 正则表达式的基本语法：

  - 一般字符`.`

    - `.`    匹配任意字符”\n“意外的字符。

    - 在DOTALL模式中也可以匹配换行符。

      `re.findall("a.b","acb")`

      匹配到了`['acb']`

    - #### 但是需要注意的是：`.`不会匹配换行符号"\n"

      -  比如`re.findall(".","\n")`会匹配到`[]`

    - 但是我们可以开启多行模式，来支持匹配多行模式：

      - 比如`re.findall(".","\n",re.DOTALL)`或者可以写缩写
      - `re.findall(".","\n",re.S)`也是可以的！

  - 一般字符`\`

    - `\`是一个转义字符，使后面一个字符改变原来的意思。
    - 如果字符串中有字符`*`需要匹配，可以使用`\*`或者字符集`[*]`。
    - 比如`re.findall("hello\*","hello*")`这样的话他就可以把`*`也一起匹配了！`['hello*']`

  - 一般字符`[....]`

    - 字符集（字符类）。对应的位置可以是字符集中任意字符。

    - 字符集中的字符可以逐个列出，也可以给出范围，如`[abc]`或者干脆`[a-c]`。第一个字符如果是`^`则代表去反，如果`[^abc]`表示不是abc的其他字符

    - 所有的特殊字符在字符集中都失去其原有的特殊含义。在字符集中如果要使用`],-或^`，可以在前面加上反斜杠，或把`],-`放在第一个字符，把`^`放在非第一个字符

      ```python
      In [9]: re.findall("[a-z|0-9]","abc123d")   
          
      #由于一般字符`[]`里面默认只可以匹配一个字符，所以我们列表的每个元素都只有一个字符
          
      #这里我匹配字母或者是数字如果想要全部匹配可以查看下面的代码                          
      Out[9]: ['a', 'b', 'c', '1', '2', '3', 'd']
      ```

      ```python
      In [10]: re.findall("[a-z|0-9]*","abc123d")                                       
      Out[10]: ['abc123d', '']
      ```

  - 匹配数字`\d`或者不匹配数字`\D`

  - 匹配字母`\w`或者不匹配字母`\W`

  - 匹配空白字符`\s`或者不匹配空白字符`\S`

  - #### 数量词

  - `*`匹配前一个字符0或者无限次

  - `+`匹配前一个字符1或者无限次

  - `？`匹配前一个字符0或者1次，非贪婪模式

  - `{m}`匹配前一个字符m次

- `re.sub("需要匹配的正则表达式","替换的字符","需要使用的字符串")`

  - 比如：

    ```python
    in:b = "hello123world"
    in:re.sub("\d"," ",b)
    #把数字匹配成空格
    out:'[hello   world]'
    ```

- re.compile("需要匹配的正则表达式")

  - 比如：

    ```python
    In [1]: string = "hello123world"                          
    
    In [2]: r = re.compile("\d") #生成对应的re对象                                                    
    In [3]: r.findall(string)   #这个对象直接调用findall来查询                                                     
    Out[4]: ['1', '2', '3']
    
    In [5]: r.sub("_",string)   #或者也可以替换                                                     
    Out[6]: 'hello___world'
    
    ```

    我们可以使用re.compile(pattern)的模式生成一个对象，这个对象天生包含需要匹配的正则表达式，并且这个对象可以调用所以的re方法，所以我们可以一次生成多次使用相同的正则表达式了

  - 需要注意的是如果需要设置模式的话需要在`re.compile(".",re.S)`中事先添加好

- 正则表达式注意点

  - `re.findall("a(.*?)b","acb")`,能够返回括号中内容

    - `（）`起到定位和过滤的效果

  - 原始字符串`r`,待匹配字符串中有反斜杠的时候，使用`r`可以忽视反斜杠带来的转义效果 

  - `.`号默认情况匹配不到`\n`

  - `\s`能够匹配空白字符，不仅仅包含空格，还有`\t|\r|\n`等

    

    